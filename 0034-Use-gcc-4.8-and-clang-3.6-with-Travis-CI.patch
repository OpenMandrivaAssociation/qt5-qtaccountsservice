From 09cbd7e6f24e0a2ff999b2063a6e3cbed027c4cb Mon Sep 17 00:00:00 2001
From: Pier Luigi Fiorini <pierluigi.fiorini@gmail.com>
Date: Tue, 8 Sep 2015 19:51:25 +0200
Subject: [PATCH 34/46] Use gcc 4.8 and clang 3.6 with Travis CI

---
 .travis.yml | 22 ++++++++++++++++++----
 1 file changed, 18 insertions(+), 4 deletions(-)

diff --git a/.travis.yml b/.travis.yml
index c0e4c4d..143159d 100644
--- a/.travis.yml
+++ b/.travis.yml
@@ -1,5 +1,9 @@
 language: cpp
 
+compiler:
+  - gcc
+  - clang
+
 env:
   global:
    # The next declaration is the encrypted COVERITY_SCAN_TOKEN, created
@@ -17,12 +21,19 @@ addons:
     branch_pattern: coverity_scan
 
 before_install:
-  - "export DISPLAY=:99.0"
-  - "sh -e /etc/init.d/xvfb start"
+  - if [ "$CXX" == "g++" ]; then sudo add-apt-repository -y ppa:ubuntu-toolchain-r/test; fi
+  - if [ "$CXX" == "clang++" ]; then sudo add-apt-repository -y ppa:h-rayflood/llvm; fi
+  - sudo add-apt-repository -y ppa:beineri/opt-qt541
+  - sudo apt-get update -qq
 
 install:
-  - sudo add-apt-repository -y ppa:beineri/opt-qt541
-  - sudo apt-get update
+  # gcc
+  - if [ "$CXX" == "g++" ]; then sudo apt-get install -qq gcc-4.8 g++-4.8; fi
+  - if [ "$CXX" == "g++" ]; then export CC="gcc-4.8"; export CXX="g++-4.8"; fi
+  # clang
+  - if [ "$CXX" == "clang++" ]; then sudo apt-get install -qq clang-3.6; fi
+  - if [ "$CXX" == "clang++" ]; then export CC="clang-3.6"; export CXX="clang++-3.6"; fi
+  # qt
   - sudo apt-get -y install qt54declarative qt54tools
 
 before_script:
@@ -42,6 +53,9 @@ before_script:
   - make && make install
   - popd
   - export PATH=$HOME/ecm/bin:$PATH
+  # xvfb for unit tests
+  - "export DISPLAY=:99.0"
+  - "sh -e /etc/init.d/xvfb start"
   # prepare
   - source /opt/qt54/bin/qt54-env.sh
   - echo $PATH
-- 
1.9.5

